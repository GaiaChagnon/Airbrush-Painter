# lineart.yaml -- Configuration for the standalone line-art tracer script
#
# Controls vectorization mode, hatching parameters, and tracing defaults.
# CLI arguments override any value here.
# Loaded by robot_control/scripts/run_lineart_tracer.py.
#
# Canvas geometry (paper size, origin, margin) is read from jobs.yaml.
# All linear dimensions in millimeters unless stated otherwise.

# Operating mode: "line_tracing" or "hatched"
#   line_tracing  -- potrace outlines, no fill (B&W schematics / text)
#   hatched       -- density-based hatching with gradient support (photos / art)
mode: line_tracing

# --- Physical pen properties ------------------------------------------------
# Used by hatched mode to compute minimum hatch spacing.
# The hatch_pitch_mm should be >= line_width_mm to avoid ink bleed.
line_width_mm: 0.3                   # Pen trace width on paper (mm)

# --- Line-tracing mode (potrace + vpype) ------------------------------------
line_tracing:
  turdsize: 10                       # Potrace speckle filter: discard contours
                                     # with area < this many px^2
  merge_tolerance_px: 5.0            # Max px distance for vpype endpoint merging
  simplify_tol_mm: 0.05              # Douglas-Peucker tolerance (mm)
  min_path_mm: 0.5                   # Drop paths shorter than this (mm)
  threshold: null                    # Binary threshold 0-255; null = default 128

# --- Hatched mode (hatched library + vpype) ----------------------------------
hatched:
  pen_width_mm: 0.3                  # Physical pen trace width (mm);
                                     # mirrors top-level line_width_mm

  # Threshold levels (0-255) dividing the grayscale image into zones.
  # 3 thresholds = 4 zones: black | dark | light | white.
  # The hatched library interleaves hatch density automatically:
  #   zone 0 (darkest): pitch = 1x base    (densest)
  #   zone 1:           pitch = 2x base
  #   zone 2:           pitch = 4x base    (sparsest)
  #   zone 3 (white):   no hatching
  # More levels = smoother gradients (e.g., [32, 64, 96, 128, 160, 192, 224]).
  levels: [64, 128, 192]

  hatch_pitch_mm: 0.6                # Densest hatching pitch (~2x pen width);
                                     # smaller = denser fill, min ~= pen_width_mm
  hatch_angle_deg: 45.0              # Diagonal hatching angle (degrees)
  blur_radius: 10                    # Gaussian blur radius before thresholding;
                                     # smooths transitions, 0 = disabled
  image_scale: 1.0                   # Scale factor applied to image before
                                     # hatching; reduce for faster processing
  circular: false                    # true = concentric circles, false = diagonal
  invert: false                      # Invert image before processing

  include_outlines: true             # Overlay potrace outlines on hatched fill
                                     # for crisper edges
  outline_turdsize: 10               # Potrace turdsize when generating outlines
  min_path_mm: 0.3                   # Drop paths shorter than this (mm)
  simplify_tol_mm: 0.05              # Douglas-Peucker tolerance (mm)
  merge_tolerance_px: 5.0            # vpype endpoint merge tolerance (px)
